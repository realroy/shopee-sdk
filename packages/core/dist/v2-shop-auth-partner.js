import{ShopeeContext}from"./libs/index.js";import{generateHmac,toTimestamp}from"./utils/index.js";import{API_V2_SHOP_AUTH_PARTNER}from"./v2-shop.constant.js";export async function authPartner({redirectURL,redirectSign}){const{baseURL,partnerId,partnerKey}=ShopeeContext.getInstance();if(!partnerKey||!partnerId){throw new Error("partnerKey is undefined")}const url=new URL(API_V2_SHOP_AUTH_PARTNER,baseURL);const timestamp=toTimestamp(new Date);const sign=await generateHmac(partnerKey,partnerId.toString(),API_V2_SHOP_AUTH_PARTNER,timestamp);const parsedRedirectURL=new URL(redirectURL);parsedRedirectURL.searchParams.append("sign",redirectSign);url.search=new URLSearchParams({partner_id:partnerId.toString(),redirect:parsedRedirectURL.toString(),timestamp,sign}).toString();return url.toString()}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy92Mi1zaG9wLWF1dGgtcGFydG5lci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaG9wZWVDb250ZXh0IH0gZnJvbSBcIi4vbGlicy9pbmRleC5qc1wiO1xuaW1wb3J0IHsgZ2VuZXJhdGVIbWFjLCB0b1RpbWVzdGFtcCB9IGZyb20gXCIuL3V0aWxzL2luZGV4LmpzXCI7XG5pbXBvcnQgeyBBUElfVjJfU0hPUF9BVVRIX1BBUlRORVIgfSBmcm9tIFwiLi92Mi1zaG9wLmNvbnN0YW50LmpzXCI7XG5cbmltcG9ydCB0eXBlIHsgQXV0aFBhcnRuZXJSZXF1ZXN0UGFyYW1zIH0gZnJvbSBcIi4vdjItc2hvcC50eXBlLmpzXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdXRoUGFydG5lcih7XG4gIHJlZGlyZWN0VVJMLFxuICByZWRpcmVjdFNpZ24sXG59OiBBdXRoUGFydG5lclJlcXVlc3RQYXJhbXMpIHtcbiAgY29uc3QgeyBiYXNlVVJMLCBwYXJ0bmVySWQsIHBhcnRuZXJLZXkgfSA9IFNob3BlZUNvbnRleHQuZ2V0SW5zdGFuY2UoKTtcbiAgaWYgKCFwYXJ0bmVyS2V5IHx8ICFwYXJ0bmVySWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJwYXJ0bmVyS2V5IGlzIHVuZGVmaW5lZFwiKTtcbiAgfVxuXG4gIGNvbnN0IHVybCA9IG5ldyBVUkwoQVBJX1YyX1NIT1BfQVVUSF9QQVJUTkVSLCBiYXNlVVJMKTtcblxuICBjb25zdCB0aW1lc3RhbXAgPSB0b1RpbWVzdGFtcChuZXcgRGF0ZSgpKTtcblxuICBjb25zdCBzaWduID0gYXdhaXQgZ2VuZXJhdGVIbWFjKFxuICAgIHBhcnRuZXJLZXksXG4gICAgcGFydG5lcklkLnRvU3RyaW5nKCksXG4gICAgQVBJX1YyX1NIT1BfQVVUSF9QQVJUTkVSLFxuICAgIHRpbWVzdGFtcFxuICApO1xuXG4gIGNvbnN0IHBhcnNlZFJlZGlyZWN0VVJMID0gbmV3IFVSTChyZWRpcmVjdFVSTCk7XG4gIHBhcnNlZFJlZGlyZWN0VVJMLnNlYXJjaFBhcmFtcy5hcHBlbmQoXCJzaWduXCIsIHJlZGlyZWN0U2lnbik7XG5cbiAgdXJsLnNlYXJjaCA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgIHBhcnRuZXJfaWQ6IHBhcnRuZXJJZC50b1N0cmluZygpLFxuICAgIHJlZGlyZWN0OiBwYXJzZWRSZWRpcmVjdFVSTC50b1N0cmluZygpLFxuICAgIHRpbWVzdGFtcCxcbiAgICBzaWduLFxuICB9KS50b1N0cmluZygpO1xuXG4gIHJldHVybiB1cmwudG9TdHJpbmcoKTtcbn1cbiJdLCJuYW1lcyI6WyJTaG9wZWVDb250ZXh0IiwiZ2VuZXJhdGVIbWFjIiwidG9UaW1lc3RhbXAiLCJBUElfVjJfU0hPUF9BVVRIX1BBUlRORVIiLCJhdXRoUGFydG5lciIsInJlZGlyZWN0VVJMIiwicmVkaXJlY3RTaWduIiwiYmFzZVVSTCIsInBhcnRuZXJJZCIsInBhcnRuZXJLZXkiLCJnZXRJbnN0YW5jZSIsIkVycm9yIiwidXJsIiwiVVJMIiwidGltZXN0YW1wIiwiRGF0ZSIsInNpZ24iLCJ0b1N0cmluZyIsInBhcnNlZFJlZGlyZWN0VVJMIiwic2VhcmNoUGFyYW1zIiwiYXBwZW5kIiwic2VhcmNoIiwiVVJMU2VhcmNoUGFyYW1zIiwicGFydG5lcl9pZCIsInJlZGlyZWN0Il0sIm1hcHBpbmdzIjoiQUFBQSxPQUFTQSxhQUFhLEtBQVEsaUJBQWtCLEFBQ2hELFFBQVNDLFlBQVksQ0FBRUMsV0FBVyxLQUFRLGtCQUFtQixBQUM3RCxRQUFTQyx3QkFBd0IsS0FBUSx1QkFBd0IsQUFJakUsUUFBTyxlQUFlQyxZQUFZLENBQ2hDQyxXQUFXLENBQ1hDLFlBQVksQ0FDYSxFQUN6QixLQUFNLENBQUVDLE9BQU8sQ0FBRUMsU0FBUyxDQUFFQyxVQUFVLENBQUUsQ0FBR1QsY0FBY1UsV0FBVyxHQUNwRSxHQUFJLENBQUNELFlBQWMsQ0FBQ0QsVUFBVyxDQUM3QixNQUFNLElBQUlHLE1BQU0sMEJBQ2xCLENBRUEsTUFBTUMsSUFBTSxJQUFJQyxJQUFJVix5QkFBMEJJLFNBRTlDLE1BQU1PLFVBQVlaLFlBQVksSUFBSWEsTUFFbEMsTUFBTUMsS0FBTyxNQUFNZixhQUNqQlEsV0FDQUQsVUFBVVMsUUFBUSxHQUNsQmQseUJBQ0FXLFdBR0YsTUFBTUksa0JBQW9CLElBQUlMLElBQUlSLGFBQ2xDYSxrQkFBa0JDLFlBQVksQ0FBQ0MsTUFBTSxDQUFDLE9BQVFkLGFBRTlDTSxDQUFBQSxJQUFJUyxNQUFNLENBQUcsSUFBSUMsZ0JBQWdCLENBQy9CQyxXQUFZZixVQUFVUyxRQUFRLEdBQzlCTyxTQUFVTixrQkFBa0JELFFBQVEsR0FDcENILFVBQ0FFLElBQ0YsR0FBR0MsUUFBUSxHQUVYLE9BQU9MLElBQUlLLFFBQVEsRUFDckIifQ==